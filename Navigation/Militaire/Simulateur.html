<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMPERIUM - Simulateur de Combat</title>
    <meta name="description" content="Simulez vos batailles avant de lancer vos attaques dans IMPERIUM.">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%23b45309'/><text x='16' y='20' text-anchor='middle' fill='white' font-family='serif' font-size='20' font-weight='bold'>I</text></svg>" type="image/svg+xml">

    <style>
        /* =============================================================== */
        /* STYLES COMMUNS DE L'APPLICATION (common-style.css)            */
        /* =============================================================== */
        :root {
            --gold-primary: #d97706;
            --gold-secondary: #f59e0b;
            --gold-light: #fbbf24;
            --marble-white: #f8fafc;
            --roman-red: #dc2626;
            --roman-purple: #7c3aed;
            --dark-stone: #1e293b;
            --dark-marble: #334155;
            --dark-bg: #0f172a;
            --text-light: #e2e8f0;
            --text-muted: #94a3b8;
            --border-gold: rgba(217, 119, 6, 0.3);
            --shadow-gold: rgba(217, 119, 6, 0.4);
            --success-green: #22c55e;
            --storage-full-red: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Times New Roman', serif;
            background: 
                radial-gradient(circle at 20% 20%, rgba(217, 119, 6, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, var(--dark-bg) 0%, var(--dark-stone) 100%);
            color: var(--text-light);
            overflow: hidden;
            min-height: 100vh;
        }

        .particles {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1;
        }

        .particle {
            position: absolute;
            width: 3px; height: 3px;
            background: var(--gold-light);
            border-radius: 50%;
            animation: float 8s infinite linear;
            opacity: 0.6;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .imperium-ui {
            display: flex;
            flex-direction: column;
            height: 100vh;
            position: relative;
            z-index: 10;
        }

        .imperium-header {
            background: linear-gradient(135deg, var(--dark-marble) 0%, var(--dark-stone) 100%);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--border-gold);
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 100;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .imperium-logo {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .imperium-logo:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 10px var(--shadow-gold));
        }

        .resources-display {
            display: flex;
            gap: 1.5rem;
            background: rgba(15, 23, 42, 0.7);
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            border: 1px solid var(--border-gold);
        }

        .resource-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: bold;
            font-size: 1rem;
            position: relative;
        }

        .resource-icon {
            font-size: 1.2rem;
            filter: drop-shadow(0 0 5px var(--shadow-gold));
        }

        .resource-value {
            color: var(--gold-light);
            min-width: 50px;
            text-align: right;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .player-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--roman-red), var(--roman-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            border: 2px solid var(--gold-primary);
        }

        .player-details {
            font-size: 0.9rem;
        }

        .player-name {
            color: var(--gold-light);
            font-weight: bold;
        }

        .player-level {
            color: var(--text-muted);
        }

        .imperium-body {
            display: flex;
            flex-grow: 1;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            gap: 1.5rem;
            padding: 1.5rem 2rem;
            overflow: hidden;
        }

        .imperium-sidebar {
            width: 280px;
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(30, 41, 59, 0.8) 100%);
            border-radius: 1rem;
            border: 1px solid var(--border-gold);
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-title {
            color: var(--gold-primary);
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--border-gold);
            padding-bottom: 0.5rem;
        }

        .nav-list {
            list-style: none;
        }

        .nav-item a {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-light);
            text-decoration: none;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .nav-item a:hover, .nav-item a.active {
            background: linear-gradient(135deg, rgba(217, 119, 6, 0.2), rgba(245, 158, 11, 0.1));
            border-color: var(--gold-primary);
            transform: translateX(5px);
            color: var(--gold-light);
        }

        .nav-icon {
            font-size: 1.3rem;
            width: 24px;
            text-align: center;
        }

        .main-content {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
        }

        .view-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(30, 41, 59, 0.8) 100%);
            border-radius: 1rem;
            border: 1px solid var(--border-gold);
            overflow-y: auto;
            padding: 2rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .view-title {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--gold-primary);
            margin-bottom: 2rem;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* =============================================================== */
        /* STYLES SP√âCIFIQUES AU SIMULATEUR                              */
        /* =============================================================== */
        .simulator-layout {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .battle-setup {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            align-items: start;
        }

        @media (min-width: 1200px) {
            .battle-setup {
                grid-template-columns: 1fr auto 1fr;
            }
        }

        .army-setup {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 1rem;
            border: 2px solid var(--border-gold);
            padding: 1.5rem;
        }

        .army-setup.attacker { border-color: var(--roman-red); }
        .army-setup.defender { border-color: var(--success-green); }

        .army-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .army-title.attacker { color: var(--roman-red); }
        .army-title.defender { color: var(--success-green); }

        .unit-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .unit-selector {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 0.8rem;
            border: 1px solid var(--border-gold);
            padding: 1rem;
            text-align: center;
        }
        
        .unit-icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .unit-name { color: var(--gold-light); font-weight: bold; margin-bottom: 0.5rem; }
        .unit-input {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-gold);
            color: var(--text-light);
            text-align: center;
            padding: 0.5rem;
            border-radius: 0.3rem;
        }

        .vs-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 1rem 0;
        }

        .vs-icon {
            font-size: 3rem;
            color: var(--gold-primary);
        }

        .simulate-btn {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-secondary));
            color: white;
            border: none;
            border-radius: 1rem;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .simulate-btn:hover { transform: translateY(-3px); }

        .battle-result {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 1rem;
            border: 2px solid var(--gold-primary);
            padding: 2rem;
            margin-top: 2rem;
            display: none; /* Cach√© par d√©faut */
        }
        .battle-result.show { display: block; animation: slideInUp 0.5s ease; }
        .battle-result.victory { border-color: var(--success-green); }
        .battle-result.defeat { border-color: var(--roman-red); }

        .result-header { text-align: center; margin-bottom: 2rem; }
        .result-title { font-size: 2rem; font-weight: bold; }
        .result-title.victory { color: var(--success-green); }
        .result-title.defeat { color: var(--roman-red); }

        .result-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        @media (min-width: 768px) { .result-details { grid-template-columns: 1fr 1fr; } }

        .result-section-title { color: var(--gold-primary); font-weight: bold; margin-bottom: 1rem; }
        .losses-list, .loot-list { display: flex; flex-direction: column; gap: 0.5rem; }
        .loss-item, .loot-item { display: flex; justify-content: space-between; padding: 0.5rem; background: rgba(0,0,0,0.2); border-radius: 0.3rem; }
        .loss-count { color: var(--roman-red); font-weight: bold; }
        .loot-amount { color: var(--success-green); font-weight: bold; }

        .battle-report {
            background: rgba(0,0,0,0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1.5rem;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-family: monospace;
        }

        @keyframes slideInUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="particles"></div>

    <div class="imperium-ui">
        <header class="imperium-header">
            <div class="header-content">
                <h1 class="imperium-logo">IMPERIUM</h1>
                <div id="resources-display" class="resources-display"></div>
                <div class="player-info">
                    <div class="player-avatar" id="player-avatar"></div>
                    <div class="player-details">
                        <div class="player-name" id="player-name"></div>
                        <div class="player-level" id="player-title-level"></div>
                    </div>
                </div>
            </div>
        </header>

        <div class="imperium-body">
            <aside class="imperium-sidebar"></aside>

            <main class="main-content">
                <div class="view-container">
                    <h2 class="view-title">‚öîÔ∏è Simulateur de Combat</h2>
                    
                    <div class="simulator-layout">
                        <div class="battle-setup">
                            <div class="army-setup attacker">
                                <h3 class="army-title attacker">Arm√©e Attaquante</h3>
                                <div class="unit-selection" id="attacker-units"></div>
                            </div>

                            <div class="vs-section">
                                <div class="vs-icon">VS</div>
                                <button class="simulate-btn" id="simulate-battle">SIMULER</button>
                            </div>

                            <div class="army-setup defender">
                                <h3 class="army-title defender">Arm√©e D√©fenseure</h3>
                                <div class="unit-selection" id="defender-units"></div>
                            </div>
                        </div>

                        <div class="battle-result" id="battle-result">
                            <div class="result-header">
                                <div class="result-title" id="result-title"></div>
                            </div>
                            <div class="result-details">
                                <div>
                                    <h4 class="result-section-title">Pertes de l'attaquant</h4>
                                    <div class="losses-list" id="attacker-losses"></div>
                                </div>
                                <div>
                                    <h4 class="result-section-title">Pertes du d√©fenseur</h4>
                                    <div class="losses-list" id="defender-losses"></div>
                                </div>
                                <div style="grid-column: 1 / -1;">
                                    <h4 class="result-section-title">Butin</h4>
                                    <div class="loot-list" id="battle-loot"></div>
                                </div>
                            </div>
                            <div class="battle-report" id="battle-report"></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // ===============================================================
        // SCRIPTS GLOBAUX (navigation, UI, etc.)
        // ===============================================================
        const NAVIGATION_CONFIG = {
            'index':      { title: 'Accueil', file: 'index.html', section: 'Empire', icon: 'üèõÔ∏è' },
            'cite':       { title: 'Ma Cit√©', file: 'Empire/Cite.html', section: 'Empire', icon: 'üèòÔ∏è' },
            'monde':      { title: 'Monde', file: 'Empire/Monde.html', section: 'Empire', icon: 'üåç' },
            'province':   { title: 'Province', file: 'Empire/Province.html', section: 'Empire', icon: 'üèùÔ∏è' },
            'academie':   { title: 'Acad√©mie', file: 'Developpement/Academie.html', section: 'D√©veloppement', icon: 'üìö' },
            'commerce':   { title: 'Commerce', file: 'Developpement/Commerce.html', section: 'D√©veloppement', icon: '‚öñÔ∏è' },
            'legions':    { title: 'L√©gions', file: 'Militaire/L√©gions.html', section: 'Militaire', icon: '‚öîÔ∏è' },
            'flotte':     { title: 'Flotte', file: 'Militaire/Flotte.html', section: 'Militaire', icon: 'üö¢' },
            'simulateur': { title: 'Simulateur', file: 'Militaire/Simulateur.html', section: 'Militaire', icon: 'üí•' },
            'diplomatie': { title: 'Diplomatie', file: 'Social/Diplomatie.html', section: 'Social', icon: 'ü§ù' },
            'alliance':   { title: 'Alliance', file: 'Social/Alliance.html', section: 'Social', icon: 'üõ°Ô∏è' },
            'messages':   { title: 'Messages', file: 'Social/Messsages.html', section: 'Social', icon: '‚úâÔ∏è' },
            'premium':    { title: 'Premium', file: 'Premium/Premium.html', section: 'Premium', icon: 'üëë' }
        };

        function generateNavigationHTML() {
            const sections = {};
            Object.entries(NAVIGATION_CONFIG).forEach(([key, config]) => {
                if (key === 'index') return;
                if (!sections[config.section]) sections[config.section] = [];
                sections[config.section].push({ key, ...config });
            });
            
            let html = '';
            Object.entries(sections).forEach(([sectionName, pages]) => {
                html += `<div class="nav-section"><h2 class="nav-title">${sectionName}</h2><ul class="nav-list">`;
                pages.forEach(page => {
                    html += `<li class="nav-item"><a href="#" data-page="${page.key}" onclick="navigateTo('${page.key}'); return false;"><span class="nav-icon">${page.icon}</span> ${page.title}</a></li>`;
                });
                html += `</ul></div>`;
            });
            return html;
        }
        
        function navigateTo(pageKey) {
            const config = NAVIGATION_CONFIG[pageKey];
            console.log(`Navigation vers : ${config.title} (${config.file})`);
            alert(`Simulation de navigation vers : ${config.title}`);
        }

        function initializeGlobalUI() {
            document.querySelector('.imperium-sidebar').innerHTML = generateNavigationHTML();
            
            const currentPage = 'simulateur'; // Page active
            document.querySelectorAll('.nav-item a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === currentPage) {
                    link.classList.add('active');
                }
            });

            document.getElementById('player-name').textContent = 'Marcus Aurelius';
            document.getElementById('player-title-level').textContent = 'Consul - Niv. 12';
            document.getElementById('player-avatar').textContent = 'M';
            document.getElementById('resources-display').innerHTML = `
                <div class="resource-item"><span class="resource-icon">üçá</span><span class="resource-value">4,560</span></div>
                <div class="resource-item"><span class="resource-icon">üèõÔ∏è</span><span class="resource-value">2,340</span></div>
                <div class="resource-item"><span class="resource-icon">‚öîÔ∏è</span><span class="resource-value">8,900</span></div>
                <div class="resource-item"><span class="resource-icon">üí∞</span><span class="resource-value">15,200</span></div>`;
        }

        // ===============================================================
        // SCRIPTS SP√âCIFIQUES AU SIMULATEUR
        // ===============================================================
        const UNITS_CONFIG = {
            legionnaire: { name: 'L√©gionnaire', icon: 'üõ°Ô∏è', attack: 50, defense: 70 },
            archer: { name: 'Archer', icon: 'üèπ', attack: 60, defense: 40 },
            cavalier: { name: 'Cavalier', icon: 'üêé', attack: 80, defense: 60 },
            catapulte: { name: 'Catapulte', icon: 'üí•', attack: 120, defense: 20 }
        };

        function createUnitSelector(unitType, side) {
            const config = UNITS_CONFIG[unitType];
            const selector = document.createElement('div');
            selector.className = 'unit-selector';
            selector.innerHTML = `
                <div class="unit-icon">${config.icon}</div>
                <div class="unit-name">${config.name}</div>
                <input type="number" class="unit-input" id="${side}-${unitType}" value="0" min="0" placeholder="0">
            `;
            return selector;
        }

        function generateUnitSelectors() {
            const attackerContainer = document.getElementById('attacker-units');
            const defenderContainer = document.getElementById('defender-units');
            attackerContainer.innerHTML = '';
            defenderContainer.innerHTML = '';
            
            Object.keys(UNITS_CONFIG).forEach(unitType => {
                attackerContainer.appendChild(createUnitSelector(unitType, 'attacker'));
                defenderContainer.appendChild(createUnitSelector(unitType, 'defender'));
            });
        }

        function simulateBattle() {
            let attackerPower = 0;
            let defenderPower = 0;

            // Calcul simple de puissance
            Object.keys(UNITS_CONFIG).forEach(unitType => {
                const attackerCount = parseInt(document.getElementById(`attacker-${unitType}`).value) || 0;
                const defenderCount = parseInt(document.getElementById(`defender-${unitType}`).value) || 0;
                attackerPower += attackerCount * UNITS_CONFIG[unitType].attack;
                defenderPower += defenderCount * UNITS_CONFIG[unitType].defense;
            });

            const resultContainer = document.getElementById('battle-result');
            const resultTitle = document.getElementById('result-title');
            const attackerLossesEl = document.getElementById('attacker-losses');
            const defenderLossesEl = document.getElementById('defender-losses');
            const lootEl = document.getElementById('battle-loot');
            const reportEl = document.getElementById('battle-report');

            resultContainer.classList.remove('victory', 'defeat');
            
            let battleReport = `Rapport de bataille :\nPuissance Attaquant: ${attackerPower}\nPuissance D√©fenseur: ${defenderPower}\n\n`;

            if (attackerPower > defenderPower) {
                resultContainer.classList.add('victory');
                resultTitle.textContent = 'VICTOIRE !';
                resultTitle.className = 'result-title victory';

                const lossRatio = defenderPower / attackerPower;
                attackerLossesEl.innerHTML = `<div class="loss-item"><span>Total Pertes</span><span class="loss-count">~${Math.round(lossRatio * 100)}%</span></div>`;
                defenderLossesEl.innerHTML = `<div class="loss-item"><span>Total Pertes</span><span class="loss-count">100%</span></div>`;
                lootEl.innerHTML = `<div class="loot-item"><span>üí∞ Or</span><span class="loot-amount">+${Math.floor(Math.random() * 5000)}</span></div>`;
                battleReport += "L'attaquant a submerg√© les d√©fenses.";

            } else {
                resultContainer.classList.add('defeat');
                resultTitle.textContent = 'D√âFAITE !';
                resultTitle.className = 'result-title defeat';
                
                const lossRatio = attackerPower / defenderPower;
                attackerLossesEl.innerHTML = `<div class="loss-item"><span>Total Pertes</span><span class="loss-count">100%</span></div>`;
                defenderLossesEl.innerHTML = `<div class="loss-item"><span>Total Pertes</span><span class="loss-count">~${Math.round(lossRatio * 100)}%</span></div>`;
                lootEl.innerHTML = `<div class="loot-item"><span>Aucun butin</span></div>`;
                battleReport += "Le d√©fenseur a tenu bon.";
            }
            
            reportEl.textContent = battleReport;
            resultContainer.classList.add('show');
            resultContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // ===============================================================
        // INITIALISATION DE LA PAGE
        // ===============================================================
        document.addEventListener('DOMContentLoaded', function() {
            initializeGlobalUI();
            generateUnitSelectors();
            document.getElementById('simulate-battle').addEventListener('click', simulateBattle);
        });
    </script>
</body>
</html>
